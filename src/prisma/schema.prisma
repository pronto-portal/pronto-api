generator client {
  provider = "prisma-client-js"
  previewFeatures = ["extendedWhereUnique"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                String        @id @default(uuid())
  createdAt         DateTime      @default(now())
  updatedAt         DateTime      @updatedAt
  email             String        @unique() @db.VarChar(120)
  phone             String?       @db.VarChar(30)
  firstName         String?       @db.VarChar(120)
  lastName          String?       @db.VarChar(120)
  profilePic        String?       @default("") @db.VarChar(255)
  isManager         Boolean       @default(false)
  isTranslator      Boolean       @default(false)
  isBanned          Boolean       @default(false)
  assignments       Assignment[]  @relation("createdAssignments")
  assignedTo        Assignment[]  @relation("taskedAssignments")
  token             RefreshToken?
  isProfileComplete Boolean       @default(false)
  city              String?
  state             String?
  languages         String[]      @default([])
  translators       User[]        @relation("UserTranslators")
  translatingFor    User[]        @relation("UserTranslators")
  claimants         Claimant[]    @relation("UserClaimants")
  addresses         Address[]     @relation("UserAddresses")
  }

model RefreshToken {
  id     String @id @default(uuid())
  user   User   @relation(fields: [userId], references: [id])
  userId String @unique
  token  String @unique
}

model Assignment {
  id               String    @id @default(uuid())
  createdAt        DateTime  @default(now())
  assignedTo       User      @relation("taskedAssignments", fields: [assignedToUserId], references: [id])
  assignedToUserId String
  createdBy        User      @relation("createdAssignments", fields: [createdByUserId], references: [id])
  createdByUserId  String
  claimant         Claimant? @relation(fields: [claimantId], references: [id], onDelete: SetNull)
  claimantId       String? 
  dateTime         DateTime
  address          Address?  @relation(fields: [addressId], references: [id], onDelete: SetNull)
  addressId        String?
  isComplete       Boolean   @default(false)
  claimantNoShow   Boolean   @default(false)
  translatorNoShow Boolean   @default(false)
  reminder         Reminder?
}

model Claimant {
  id           String     @id @default(uuid())
  user         User       @relation("UserClaimants", fields: [userId], references: [id])
  userId       String
  firstName    String     @db.VarChar(120)
  lastName     String     @db.VarChar(120)
  email        String     @db.VarChar(120)
  phone        String     @db.VarChar(30)
  assignment   Assignment[]
  languages    String[]   @default([])
}

model Address {
  id           String     @id @default(uuid())
  user         User       @relation("UserAddresses", fields: [userId], references: [id])
  userId       String
  address1     String     @db.VarChar(255)
  address2     String?     @db.VarChar(255)
  city         String     @db.VarChar(255)
  state        String     @db.VarChar(2)
  zipCode      String     @db.VarChar(32)
  assignment   Assignment[]
}

model Reminder {
  id                    String      @id @default(uuid())
  assignment            Assignment  @relation(fields: [assignmentId], references: [id])
  assignmentId          String      @unique
  claimantSubject       String?
  claimantMessage       String
  translatorSubject     String?
  translatorMessage     String
  isEmail               Boolean     @default(true)
  isSMS                 Boolean     @default(false)
}
